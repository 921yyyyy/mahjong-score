# mahjong-score
麻雀点数管理システムの作成


申し訳ありません。ご指摘の通り、プロジェクトの骨格となる「スキャン機能」「データベース構造」「開発環境の制約」は、ドキュメントに絶対に欠かしてはならない重要な情報です。
特に「スマホで開発している」という点は、PCでの開発とはデバッグ方法やコピペのしやすさが異なるため、今後の私の提案形式に大きく関わります。
これらすべての重要情報を網羅し、「これを見ればプロジェクトのすべてがわかる」完全版のドキュメントを作成しました。
MAHJONG STATS PRO - プロジェクト定義書 (完全版)
1. プロジェクトの概要
麻雀の対局スコアをスマホカメラでスキャンし、リアルタイムで計算・記録。Supabaseを通じて個人成績やランキングを管理する。
2. コア機能（死守すべき「1の状態」）
 * リアル仕様スコアボード: 8行構成。各行にA〜Dの「+」「-」入力欄。
 * 行バランス調整（整ボタン）: A〜Cの入力からDの値を自動算出。
 * 整合性バリデーション: 横一列の合計が0でない場合、警告を表示し保存をロック。
 * スキャン機能 (OCR): Tesseract.jsを使用し、カメラ写真から数値を自動抽出してグリッドに流し込む。
 * データ永続化: 対戦結果、プレイヤー情報、集計データをSupabaseへ保存・更新。
3. データベース環境 (Supabase)
| テーブル名 | 用途 |
|---|---|
| players | プレイヤー名とIDの管理（重複防止） |
| games | 各対局（1半荘など）の生データとメタデータ |
| game_results | 1局ごとのスコア、順位、プレイヤーIDの紐付け |
| set_summaries | 累計スコアや通算成績（ランキング表示用） |
4. 開発・実行環境
 * 開発スタイル: スマートフォンのみで開発。GitHubのWebエディタを使用してコードを編集・コミット。
 * インフラ:
   * GitHub Pages: ホスティング（公開環境）。
   * Supabase: バックエンド（DB / Auth）。
 * 外部ライブラリ:
   * Tesseract.js (OCR)
   * Grid.js (データ一覧表示)
   * Lucide Icons (アイコン)
   * Tailwind CSS (スタイリング)
5. 運用・修正ルール (人為的ミス防止策)
 * スマホ最適化コピペ: スマホでの編集ミスを防ぐため、Geminiは「全書き換え」を避け、**「特定のコメント行の間に挿入するコード」**という形で差分を提示する。
 * ブランチ運用の徹底:
   * main: 常に動作する「1の状態」を維持。
   * feature-xxx: 新機能（タブ遷移、デザイン変更など）を試す場所。
 * キャッシュ対策: index.html のJS読み込みURLに ?v=日時 を付与し、スマホブラウザの古いキャッシュを強制的に上書きする。
 * 検証フロー: 修正後は「シークレットモード」でGitHub Pagesを確認し、動作OKであれば main へマージする。
