<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ€„ éº»é›€ã‚¹ã‚³ã‚¢ç®¡ç† (Cloud Sync)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { background-color: #0f172a; color: #f1f5f9; font-family: sans-serif; -webkit-text-size-adjust: 100%; }
        /* ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰ã®ãƒ‡ã‚¶ã‚¤ãƒ³ç¶­æŒ */
        .score-grid { display: grid; grid-template-columns: 35px repeat(4, 1fr); gap: 1px; background-color: #334155; border: 1px solid #475569; }
        .grid-header { background-color: #1e293b; padding: 6px 2px; text-align: center; font-size: 10px; font-weight: bold; color: #94a3b8; }
        .grid-cell { background-color: #1e293b; padding: 2px; display: flex; gap: 1px; }
        input[type="number"] { width: 50%; background: #0f172a; color: white; border: none; text-align: center; font-size: 12px; padding: 8px 0; border-radius: 4px; }
        .input-plus { color: #60a5fa; }
        .input-minus { color: #f87171; }
        /* ãƒ¢ãƒ¼ãƒ€ãƒ« */
        #saveModal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 50; align-items: center; justify-content: center; padding: 20px; }
    </style>
</head>
<body class="pb-10">
    <div class="max-w-md mx-auto p-4 space-y-4">
        <header class="flex justify-between items-center py-2">
            <h1 class="text-xl font-black text-orange-500 italic">1ã®é€²åŒ–å½¢ v2.0</h1>
            <button id="viewHistory" class="text-xs bg-slate-700 px-3 py-2 rounded-lg">å±¥æ­´ã‚’è¡¨ç¤º</button>
        </header>

        <div id="scannerSection" class="space-y-4">
            <div class="flex gap-2">
                <input type="file" id="imageInput" accept="image/*" class="hidden">
                <button onclick="document.getElementById('imageInput').click()" class="flex-1 py-4 bg-indigo-600 rounded-xl font-bold">ğŸ“· å†™çœŸã‚’é¸æŠ</button>
                <button id="analyzeBtn" class="px-6 py-4 bg-orange-500 rounded-xl font-bold">ğŸ¯ è§£æ</button>
            </div>
            
            <div class="bg-slate-800 p-4 rounded-2xl space-y-4 border border-slate-700">
                <div class="grid grid-cols-2 gap-4">
                    <input type="range" id="adjustX" min="-500" max="800" value="0">
                    <input type="range" id="adjustY" min="-800" max="800" value="0">
                    <input type="range" id="adjustW" min="0.5" max="3.5" step="0.01" value="1.0">
                    <input type="range" id="adjustH" min="0.5" max="2.5" step="0.01" value="1.0">
                </div>
                <canvas id="previewCanvas" class="w-full rounded-lg bg-black"></canvas>
            </div>

            <div class="score-grid rounded-lg overflow-hidden">
                <div class="grid-header">å›</div>
                <div class="grid-header">A (+/-)</div><div class="grid-header">B (+/-)</div>
                <div class="grid-header">C (+/-)</div><div class="grid-header">D (+/-)</div>
                <div id="gridBody" class="contents"></div>
                <div class="bg-slate-800 text-center py-3 font-bold text-xs text-slate-500">è¨ˆ</div>
                <div id="totalA" class="bg-slate-800 text-center py-3 font-bold text-blue-400">0</div>
                <div id="totalB" class="bg-slate-800 text-center py-3 font-bold text-blue-400">0</div>
                <div id="totalC" class="bg-slate-800 text-center py-3 font-bold text-blue-400">0</div>
                <div id="totalD" class="bg-slate-800 text-center py-3 font-bold text-blue-400">0</div>
            </div>

            <button id="preSaveBtn" class="w-full py-5 bg-emerald-600 rounded-2xl font-black shadow-lg shadow-emerald-900/20">
                ğŸ’¾ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’é¸ã‚“ã§ä¿å­˜
            </button>
        </div>
    </div>

    <div id="saveModal">
        <div class="bg-slate-800 w-full max-w-sm p-6 rounded-3xl space-y-6 border border-slate-600 shadow-2xl">
            <h2 class="text-center font-bold text-lg">å¯¾å±€è€…ã‚’æ±ºå®š</h2>
            <div id="playerInputs" class="space-y-4">
                </div>
            <div class="flex gap-3">
                <button onclick="document.getElementById('saveModal').style.display='none'" class="flex-1 py-3 bg-slate-700 rounded-xl font-bold">æˆ»ã‚‹</button>
                <button id="finalSaveBtn" class="flex-1 py-3 bg-emerald-500 rounded-xl font-bold">DBã«ä¿å­˜</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
